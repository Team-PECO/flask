<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>로봇 수동 조작</title>
    <link rel="stylesheet" href="styles/control.css">
</head>
<body>
    <div class="container">
        <div class="title" onclick="gotoHome()">로봇 수동 조작</div>
        
        <div class="button-container">
            <div class="button" onclick="moveRobot('up')">
                <span class="button-text">↑</span>
            </div>
            <div class="row">
                <div class="button" onclick="moveRobot('left')">
                    <span class="button-text">←</span>
                </div>
                <div class="button" onclick="moveRobot('right')">
                    <span class="button-text">→</span>
                </div>
            </div>
            <div class="button" onclick="moveRobot('down')">
                <span class="button-text">↓</span>
            </div>
        </div>
        
        <div class="map-button" onclick="startMapping()">
            <span class="map-button-text">맵핑</span>
        </div>
    </div>

    <script>
        // 서버에서 IP 주소를 읽어서 이동하는 함수
        async function gotoHome() {
            try {
                const response = await fetch('/get-ip');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const ip = await response.text();
                window.location.href = `http://${ip.trim()}:8000/`;
            } catch (error) {
                console.error("Error fetching IP address:", error);
            }
        }

        // 방향에 따라 로봇을 움직이는 함수
        async function moveRobot(direction) {
            try {
                const response = await fetch('/get-ip');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const ip = await response.text();
                const controlResponse = await fetch(`http://${ip.trim()}:8000/${direction}`);
                if (!controlResponse.ok) {
                    throw new Error(`HTTP error! status: ${controlResponse.status}`);
                }
                const data = await controlResponse.json();
                console.log(data);
            } catch (error) {
                console.error('There was a problem with the fetch operation:', error);
            }
        }

        // 맵핑 시작 함수
        function startMapping() {
            alert('맵핑을 시작합니다.');
        }
    </script>
</body>
</html>
